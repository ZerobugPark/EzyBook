# ✈️ 간편한 예약으로 액티비티를 더 가까이 EzyBook
![ReadMeTitle](https://github.com/user-attachments/assets/261e3f47-aecf-4b38-ae8b-6837c6277129)
<br><br><br>


## 프로젝트 소개
"EzyBook"은 Easy(쉬운)와 Book(예약)의 합성어로, 누구나 쉽고 간편하게 액티비티를 예약할 수 있는 서비스입니다.  
국내외 다양한 액티비티를 조회하고, PG 결제를 통해 안전하게 예약할 수 있으며,  
커뮤니티와 채팅 기능을 통해 판매자와 실시간으로 소통하거나 예약 후기를 확인할 수 있습니다.  
또한 사용자가 직접 다녀온 액티비티에 대한 리뷰 작성도 가능합니다.


### 주요 기능
#### 1. 회원 및 인증(JWT)
- 소셜/이메일 로그인: 카카오톡, 애플, 이메일 회원 가입/로그인
- 자동 로그인: 앱 재실행 시 자동 로그인 유지

#### 2. 액티비티 탐색 및 예약
- 국내외 액티비티 조회 (카테고리별 / 국가별 필터링 가능)
- 예약 및 결제: PG 연동을 통한 안전한 결제 시스템

#### 3. 소통 및 후기
- 실시간 채팅: Socket 기반의 호스트-유저 간 1:1 채팅
- 리뷰 기능: 이용 후 텍스트 및 이미지 리뷰 작성 가능
- 커뮤니티: 업데이트 예정

#### 4. 배너 및 웹뷰 브릿징
- 배너 노출: 검색 화면에서 이벤트/프로모션 배너 노출
- 웹뷰 브릿징: 배너 선택 시 앱 내 웹뷰를 통해 광고 페이지로 이동 / 웹뷰 내 버튼 클릭 시 앱으로 이벤트 전달 



<br><br>

## 프로젝트 정보
기획 및 개발: 2025.05.12 ~ 2025.07.12(약 2달간)  
유지보수 및 기능 업데이트: 2025.07.13 ~  

<br>

### 기술 스택
- **FrameWork** - SwfitUI, Combine, WebKit
- **Library** - KakaoSDK, Realm, iamport_ios, SocketIO, Alamofire, Firebase
- **Architecture** - CleanArchitecture + MVVM + Coordinator(Navigation Stack based)  

<br><br>

### 기술 설명
- **최소 지원 iOS 버전**: iOS 16.0
- **Local DB**: Realm

<br><br>

## 아키텍쳐 기준과 브랜치 전략

### 아키텍쳐 선정 기준
업데이트

### 이미지 로딩 최적화 (ETag · Memory · Disk Cache)
이미지 로딩 성능과 네트워크 사용량을 최적화하기 위해 ETag 기반 캐싱과 메모리/디스크 캐시를 함께 적용했습니다.  
  
**ETag 기반 검증**
- 서버의 ETag가 변경되지 않았을 경우, 불필요한 네트워크 요청 없이 캐시된 데이터를 사용합니다.

**캐시 우선 로딩**
- 메모리 캐시 → 디스크 캐시 순으로 데이터를 조회하며, 캐시에 없을 경우에만 네트워크 요청을 수행합니다.  

**동적 리소스 대응**
- 광고 배너, 정적 리소스뿐 아니라 프로필 이미지 등 URL이 변경될 수 있는 동적 리소스에도 ETag 캐싱을 적용했습니다.
- 이를 통해 같은 URL에서 이미지가 갱신되는 경우에도 최신 데이터를 안정적으로 가져오면서 불필요한 데이터 사용을 최소화합니다.

### 이미지 리사이징 및 업로드 최적화
아이폰은 기본적으로 **HEIC(고효율 이미지 포맷)**으로 이미지를 저장하며, 일반적인 사진은 5MB 이하로 저장됩니다(※ RAW 및 야간 모드 제외).  
그러나 서버는 JPG, JPEG, PNG 확장자만 허용하며 1MB 이하의 이미지만 업로드 가능하므로, 단순 압축보다는 리사이징 후 압축하는 방식을 채택했습니다.  
  
**리사이징 우선 적용**
- 이미지의 가로 또는 세로가 1,200px을 초과할 경우, 긴 변을 최대 1,200px로 맞추고 짧은 변은 비율에 따라 자동 축소합니다.

**반복 압축(1MB 이하 보장)**
- 리사이징 후에도 1MB를 초과하면, JPEG 손실 압축률을 10% 단위로 점진적으로 낮추며 1MB 이하가 될 때까지 반복합니다.  



### Prefetch 최적화가 적용된 Cursor 기반 Pagination
사용자의 스크롤 동작에 맞춰 Prefetch + Cursor 기반 Pagination을 결합하여 자연스러운 무한 스크롤 경험을 제공합니다.  
  
**Prefetch 우선 처리**
- 스크롤 이벤트에 따라 **다음 데이터(+1 인덱스)**를 미리 로딩해, 사용자가 도달하기 전에 데이터를 준비합니다.
- Prefetch는 현재 보유한 데이터 범위 내에서만 동작하며, 데이터가 없을 경우 Cursor 기반 Pagination으로 전환됩니다.
- 상황에 따라 Prefetch 또는 Pagination 중 하나만 수행됩니다.

**중복 호출 방지**
- Set 컬렉션으로 요청 여부를 관리해 같은 데이터에 대한 중복 호출을 방지합니다.

**비동기 병렬 처리**
- 새로운 데이터를 가져온 후 **대기 중이던 요청(Pending)**을 한꺼번에 처리합니다.
- 이 과정은 TaskGroup을 활용해 비동기로 병렬 실행되며, 네트워크 대기 시간을 최소화합니다.





<br><br>

## 페이지별 기능

### [로그인 및 회원가입]

- 앱 실행시 로그인이 나오며 다음 페이지로 이동됩니다.  
- 회원가입은 이메일, 패스워드, 닉네임은 필수이며, 다음 조건을 만족해야 합니다:
  - 유효한 형식의 이메일
  - 동일한 닉네임은 사용할 수 없습니다.
  - 비밀번호는 최소 8자 이상이며 영문자, 숫자, 특수문자((@$!%*#?&))를 각각 1개 이상 포함
- 기존에 로그인을 했다면, refreshToken 여부에 따라 자동로그인을 지원합니다.

| 로그인 및 회원가입 |
|:--------:|
| <img src="https://github.com/user-attachments/assets/b375bd96-a503-4603-ace2-28f0d562a0a8" width="350"/> | 
 

<br><br>

### [메인 화면]

- 홈 화면에서는 신규 액티비티 및 전체 액티비티를 확인할 수 있습니다.
- 국가 또는 카테고리별 필터가 제공됩니다.


| 메인 화면 |
|:--------:|
| <img src="https://github.com/user-attachments/assets/4703e918-ab3e-4a0e-a9da-84eccb12584d" width="350"/> |


<br><br>

### [검색 및 웹뷰 브릿징]

- 검색 화면에서는 국나 또는 카테고리 등으로 검색할 수 있습니다.
- 배너(광고)를 클릭하면 웹뷰 화면으로 이동하며, 웹뷰 내 특정 동작(버튼 클릭 등)은 네이티브로 이벤트가 전달됩니다.


| 검색 및 웹뷰 브릿징 |
|:--------:|
| <img src="https://github.com/user-attachments/assets/b155efeb-d3d0-4a03-8279-5f161f28746a" width="350"/> |

<br><br>

### [상세화면 및 PG 결제]

- 상세화면에서는 홍보 영상/이미지, 투어 일정, 예약, 문의하기가 가능합니다.
- 예약 날짜 및 인원을 선택하고, 결제하기를 누르면 결제가 가능합니다.

 
| 상세화면 및 PG 결제 |
|:--------:|
| <img src="https://github.com/user-attachments/assets/63fd42bb-ca5a-407f-9d1a-380e69982eb3" width="350"/> |

<br><br>

### [프로필 설정]

- 프로필 설정에서 사진 등을 변경하실 수 있습니다.
- 프로필 설정에서, 종료된 투어는 리뷰를 남길 수 있습니다.ㄷ
 
| 프로필 설정 |
|:--------:|
| <img src="https://github.com/user-attachments/assets/c3300493-95a1-4399-8b40-73a4856cf9f8" width="350"/> |


<br><br>












